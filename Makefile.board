ifeq ($(BOARD),)
$(error Variable not set in app/lib Makefile: BOARD \
	    (see maker/Makefile.board for options))
endif

# We override because when this file is included from a nested build directory
# (say, when the app or toolchain has more than one build artifact, each built
# by its own makefile), the CFLAGS are passed via '$(MAKE) -e', with which
# changing the value of a variable is only possible with override. It's ugly,
# but hopefully, this is enough to make things work.

ifeq ($(BOARD),wisp)
BOARDDEF = BOARD_WISP
DEVICE  = msp430fr5969
DEVICEDEF = __MSP430FR5969__
FAMILYDEF = __MSP430FR__
endif

ifeq ($(BOARD),mspts430)
BOARDDEF = BOARD_MSP_TS430
DEVICE  = msp430fr5969
DEVICEDEF = __MSP430FR5969__
FAMILYDEF = __MSP430FR__
endif

ifeq ($(BOARD),edb)
BOARDDEF = BOARD_EDB
DEVICE  = msp430f5340
DEVICEDEF = __MSP430F5340__
FAMILYDEF = __MSP430F__
endif

ifeq ($(BOARD),edb-1.1)
BOARDDEF = BOARD_EDB_1_1
DEVICE  = msp430f5340
DEVICEDEF = __MSP430F5340__
FAMILYDEF = __MSP430FR__
endif

ifeq ($(BOARD),sprite-edb)
BOARDDEF = BOARD_SPRITE_EDB
DEVICE  = cc430f5137
DEVICEDEF = __CC430F5137__
FAMILYDEF = __CC430__
endif

ifeq ($(BOARD),sprite-edb-v1.1)
BOARDDEF = BOARD_SPRITE_EDB_1_1
DEVICE  = cc430f5137
DEVICEDEF = __CC430F5137__
FAMILYDEF = __CC430__
endif

ifeq ($(BOARD),sprite-edb-v1.2)
BOARDDEF = BOARD_SPRITE_EDB_1_2
DEVICE  = cc430f5137
DEVICEDEF = __CC430F5137__
FAMILYDEF = __CC430__
endif

ifeq ($(BOARD),sprite-app)
BOARDDEF = BOARD_SPRITE_APP
DEVICE  = msp430fr5949
DEVICEDEF = __MSP430FR5949__
FAMILYDEF = __MSP430FR__
endif

ifeq ($(BOARD),sprite-app-v1.1)
BOARDDEF = BOARD_SPRITE_APP_1_1
DEVICE  = msp430fr5949
DEVICEDEF = __MSP430FR5949__
FAMILYDEF = __MSP430FR__
endif

ifeq ($(BOARD),sprite-app-v1.2)
BOARDDEF = BOARD_SPRITE_APP_1_2
DEVICE  = msp430fr5949
DEVICEDEF = __MSP430FR5949__
FAMILYDEF = __MSP430FR__
endif

ifeq ($(BOARD),sprite-edb-socket-rgz)
BOARDDEF = BOARD_SPRITE_EDB_SOCKET_RGZ
DEVICE  = cc430f5137
DEVICEDEF = __CC430F5137__
FAMILYDEF = __CC430__
endif

ifeq ($(BOARD),sprite-app-socket-rha)
BOARDDEF = BOARD_SPRITE_APP_SOCKET_RHA
DEVICE  = msp430fr5949
DEVICEDEF = __MSP430FR5949__
FAMILYDEF = __MSP430FR__
endif

ifeq ($(BOARD),sprite-app-socket-rgz)
BOARDDEF = BOARD_SPRITE_APP_SOCKET_RGZ
DEVICE  = msp430fr5969
DEVICEDEF = __MSP430FR5969__
FAMILYDEF = __MSP430FR__
endif

ifeq ($(BOARD),sprite-app-launchpad)
BOARDDEF = BOARD_SPRITE_APP_LAUNCHPAD
DEVICE  = msp430fr5969
DEVICEDEF = __MSP430FR5969__
FAMILYDEF = __MSP430FR__
endif

ifeq ($(BOARD),msp-exp430fr6989)
BOARDDEF = BOARD_MSP_EXP430FR6989
DEVICE  = msp430fr6989
DEVICEDEF = __MSP430FR6989__
FAMILYDEF = __MSP430FR__
endif

ifeq ($(BOARD),msp-exp430fr5994)
BOARDDEF = BOARD_MSP_EXP430FR5994
DEVICE  = msp430fr5994
DEVICEDEF = __MSP430FR5994__
FAMILYDEF = __MSP430FR__
endif

ifeq ($(BOARD),msp-ts430rha40a)
BOARDDEF = BOARD_MSP_TS430RHA40A
DEVICE  = msp430fr5949
DEVICEDEF = __MSP430FR5949__
FAMILYDEF = __MSP430FR__
endif

ifeq ($(BOARD),capybara)
BOARDDEF = BOARD_CAPYBARA
FAMILYDEF = __MSP430FR__
ifeq ($(BOARD_MAJOR),1)
DEVICE  = msp430fr5949
DEVICEDEF = __MSP430FR5949__
else ifeq ($(BOARD_MAJOR),2)
DEVICE  = msp430fr5994
DEVICEDEF = __MSP430FR5994__
else # BOARD_MAJOR
$(error Device not specified for given board version)
endif # BOARD_MAJOR
endif # capybara

ifeq ($(FAMILYDEF),__MSP430FR__)
PERIPHDEFS += __MSP_EUSCI__
else ifeq ($(FAMILYDEF),__CC430__)
PERIPHDEFS += __MSP_USCI__
endif # FAMILYDEF

BOARDDEFS = \
	-D$(BOARDDEF) \
	-D$(DEVICEDEF) \
	-D$(FAMILYDEF) \
	$(foreach d,$(PERIPHDEFS),-D$(d)) \

ifneq ($(BOARD_MAJOR),)
BOARDDEFS += -DBOARD_MAJOR=$(BOARD_MAJOR)
endif

ifneq ($(BOARD_MINOR),)
BOARDDEFS += -DBOARD_MINOR=$(BOARD_MINOR)
endif


# For use in makefiles
export BOARD
export DEVICE
export FAMILYDEF
export DEFICEDEF
export BOARDDEFS
